# SOC ML Project — Анализ логов с помощью LSTM и BERT

**Дипломный проект** по теме "Применение анализа данных и ML для автоматизации задач в SOC (Security Operations Center)".

## Описание

В проекте используется датасет логов **HDFS (Hadoop Distributed File System)**, содержащий как нормальные события, так и аномалии. Цель — автоматизировать анализ логов и обнаружение аномалий.

## Цели

- Предсказать следующее лог-событие на основе предыдущих (LSTM)
- Классифицировать последовательность логов как `Normal` или `Anomaly` (BERT)

## Используемые технологии

- Python 3.9
- PyTorch
- Hugging Face Transformers
- Pandas / Regex / scikit-learn / tqdm


## Работа с данными

###  Описание исходного датасета

- Датасет: `HDFS.log` и `anomaly_label.csv`
- Содержит последовательности логов с метками `Normal` и `Anomaly`
- Изначально сильно несбалансирован:
  -  `Normal`: 266 000+
  -  `Anomaly`: ~6 600

### Балансировка для обучения

Для обучения модели BERT используется **сбалансированная обучающая выборка**:

- 6 640 нормальных сессий
- 6 640 аномальных сессий  
**Получаем: 13 280 лог-сессий, сбалансированное 50/50 распределение**

Для оценки модели используется **тестовая выборка с реальным распределением классов**.

##  Модели

### 1. LSTM
- Прогноз следующего события
- Accuracy@1: 54.5%
- Accuracy@5: 76.5%

### 2. BERT
- Классификация сессии логов
- Accuracy: 98.05%
- Precision: 80%
- Recall: 9.5%
- F1-score: 17%

## Структура

- `data/` — исходные лог-файлы и метки
- `notebooks/hdfs_parsing.ipynb` — основной ноутбук
- `requirements.txt` — зависимости

## Как запустить

1. Клонировать репозиторий:
   ```
   git clone https://github.com/yourname/soc_ml_project.git
   cd soc_ml_project
   ```
2. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```
3. Запустите hdfs_parsing.ipynb в Jupyter или VS Code